LOAD CSV WITH HEADERS FROM '%dataImportLink%/csv/fxRates.csv'
AS line

MATCH (c1:Currency {id:line.CurrencyISO})

WITH *

MATCH (c2:Currency {id:'USD'})

MERGE (fxRate:FXRate {value:toFloat(line.ValueToUSD)})
MERGE (c1)<-[:FROM]-(fxRate)-[:TO]->(c2)
MERGE (value:FXValue {value:toFloat(line.ValueToUSD), from:toInt(timestamp()/1000)})
MERGE (value)-[:OF]->(fxRate)
MERGE (fxRate)-[:LAST]->(value)
